var news_win=Ti.UI.currentWindow,news_detail_win=Ti.UI.createWindow({backgroundColor:"#DFDFDF",theme:"Theme.AppCompat.NoTitleBar.Fullscreen",touchEnabled:!1}),url="http://172.16.129.180/pattani/title_news.php",table=Ti.UI.createTableView(),main_table=Ti.UI.createTableView(),rowarr=[],client=Ti.Network.createHTTPClient({onload:function(){var e=JSON.parse(this.responseText),i=Ti.Platform.displayCaps.platformWidth,t=Ti.Platform.displayCaps.platformHeight;if(i>t)var a="landscape";else var a="portrait";var r=!1;if("portrait"==a)var o=Ti.UI.createAnimation({left:"60%",duration:500}),n=Ti.UI.createAnimation({left:0,duration:500}),l=Ti.UI.createView({backgroundColor:"#E6E6E6",width:"100%",height:"90%",top:"10%",left:0}),d=Ti.UI.createView({backgroundColor:"#23BE94",width:"100%",height:"10%",top:0,left:0}),c=Ti.UI.createView({backgroundColor:"#484848",width:"60%",height:"100%",left:0,top:"10%"}),h=Ti.UI.createView({backgroundColor:"#484848",width:"60%",height:"10%",top:0,left:0});else var o=Ti.UI.createAnimation({left:"40%",duration:500}),n=Ti.UI.createAnimation({left:0,duration:500}),l=Ti.UI.createView({backgroundColor:"#E6E6E6",width:"100%",height:"85%",top:"15%",left:0}),d=Ti.UI.createView({backgroundColor:"#23BE94",width:"100%",height:"15%",top:0,left:0}),c=Ti.UI.createView({backgroundColor:"#484848",width:"60%",height:"100%",left:0,top:"15%"}),h=Ti.UI.createView({backgroundColor:"#484848",width:"60%",height:"15%",top:0,left:0});Ti.Gesture.addEventListener("orientationchange",function(e){Ti.Gesture.orientation==Ti.UI.PORTRAIT?(r=!1,o.left="60%",l.top="10%",l.left=0,l.height="90%",d.height="10%",d.left=0,c.top="10%",h.height="10%"):(r=!1,o.left="40%",l.top="15%",l.left=0,l.height="85%",d.height="15%",d.left=0,c.top="15%",h.height="15%")});var g=Ti.UI.createImageView({image:"/Images/home.png",height:"70%",width:Ti.UI.SIZE,left:10}),p=Ti.UI.createLabel({text:"กลับสู่หน้าหลัก",color:"white",left:70}),w=Ti.UI.createLabel({color:"white",font:{fontSize:20},text:"ข่าว",textAlign:"center"}),m=Ti.UI.createImageView({image:"/Images/menu.png",left:10,height:"70%"});h.addEventListener("click",function(){news_win.close(),r=!1,l.left=0,d.left=0}),m.addEventListener("click",function(e){r?(l.animate(n),d.animate(n),r=!1):(l.animate(o),d.animate(o),r=!0)});for(var s=0;s<e.menu.length;s++){var I=e.menu[s],T=Ti.UI.createTableViewRow({index:I.id,text_index:I.title}),_=Ti.UI.createView({backgroundColor:"#484848",width:"100%",height:50,left:0,index:I.id,text_index:I.title}),f=Ti.UI.createLabel({color:"white",text:I.title,left:40,index:I.id,text_index:I.title}),u=Ti.UI.createImageView({image:"/Images/list_icon.png",height:"50%",left:10,index:I.id,text_index:I.title});_.add(f),_.add(u),T.add(_),rowarr.push(T),_.addEventListener("click",function(i){for(var t=[],a=[],o=0;o<e.news.length;o++){var c=e.news[o];if(a.push(c.detail),i.source.index==c.reference){var h=Ti.UI.createTableViewRow({text_title:i.source.text_index,index:o}),g=Ti.UI.createView({background:"#484848",width:"100%",height:100,left:0,borderColor:"black",borderWidth:"0.5",text_title:i.source.text_index,index:o}),p=Ti.UI.createLabel({color:"black",text:c.title,top:10,left:10,text_title:i.source.text_index,index:o}),m=Ti.UI.createLabel({color:"#777",text:c.start_date.slice(0,10),bottom:10,right:10,text_title:i.source.text_index,index:o});g.add(p),g.add(m),h.add(g),t.push(h),g.addEventListener("click",function(e){var i=Ti.UI.createView({backgroundColor:"#23BE94",width:"100%",height:"10%",top:0,left:0}),t=Ti.UI.createImageView({image:"/Images/back_icon.png",height:"70%",width:Ti.UI.SIZE,left:10}),r=Ti.UI.createLabel({color:"white",font:{fontSize:20},textAlign:"center",text:e.source.text_title}),o=Ti.UI.createWebView({html:a[e.source.index],top:"10%",height:"90%",width:"100%"});t.addEventListener("click",function(){news_detail_win.close()}),i.add(r),i.add(t),news_detail_win.add(i),news_detail_win.add(o),news_detail_win.open()})}}main_table.setData(t),l.add(main_table),r=!1,l.animate(n),d.animate(n),w.text=i.source.text_index})}table.setData(rowarr),h.add(p),h.add(g),c.add(table),news_win.add(c),d.add(m),d.add(w),news_win.add(h),news_win.add(d),news_win.add(l)}});client.open("GET",url),client.send();